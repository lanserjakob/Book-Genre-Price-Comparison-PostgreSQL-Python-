CREATE TABLE genre (
    id INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    name TEXT NOT NULL UNIQUE
);

CREATE TABLE geschaefte (
    id INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    name TEXT NOT NULL,
    ort TEXT
);

CREATE TABLE produkte (
    id INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    name TEXT NOT NULL,
    genre_id INT NOT NULL,
    einheit TEXT,
    CONSTRAINT fk_genre FOREIGN KEY (genre_id)
        REFERENCES genre(id)
        ON DELETE CASCADE
);

CREATE TABLE preise (
    id INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    produkt_id INT NOT NULL,
    geschaeft_id INT NOT NULL,
    datum DATE NOT NULL,
    preis_euro NUMERIC(10,2) NOT NULL,
    quelle TEXT,
    CONSTRAINT fk_produkt FOREIGN KEY (produkt_id)
        REFERENCES produkte(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_geschaeft FOREIGN KEY (geschaeft_id)
        REFERENCES geschaefte(id)
        ON DELETE CASCADE
);
